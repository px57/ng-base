{"ast":null,"code":"import { CapsuleTime } from 'src/app/services/playroom.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/playroom.service\";\nfunction TicketsListComponent_ng_container_1_h2_3_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"My \");\n    i0.ɵɵelementStart(2, \"strong\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \" tickets\");\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r6.ticket_counter);\n  }\n}\nfunction TicketsListComponent_ng_container_1_h2_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h2\");\n    i0.ɵɵtemplate(1, TicketsListComponent_ng_container_1_h2_3_ng_container_1_Template, 5, 1, \"ng-container\", 1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.ticket_counter !== 0);\n  }\n}\nfunction TicketsListComponent_ng_container_1_h2_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h2\")(1, \"strong\");\n    i0.ɵɵtext(2, \"100\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3, \" Last winner \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TicketsListComponent_ng_container_1_ul_6_ng_container_1_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 9);\n  }\n}\nfunction TicketsListComponent_ng_container_1_ul_6_ng_container_1_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 10);\n    i0.ɵɵelement(1, \"app-gold-number\", 11);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const number_r12 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"number\", number_r12.value)(\"gold\", number_r12.state);\n  }\n}\nconst _c0 = function (a0, a1) {\n  return {\n    \"delete_this_line\": a0,\n    \"winner\": a1\n  };\n};\nfunction TicketsListComponent_ng_container_1_ul_6_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"li\", 6);\n    i0.ɵɵtemplate(2, TicketsListComponent_ng_container_1_ul_6_ng_container_1_div_2_Template, 1, 0, \"div\", 7);\n    i0.ɵɵtemplate(3, TicketsListComponent_ng_container_1_ul_6_ng_container_1_span_3_Template, 2, 2, \"span\", 8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const item_r8 = ctx.$implicit;\n    const i_r9 = ctx.index;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(3, _c0, item_r8.state === \"delete_line\", i_r9 === 0));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", item_r8.state === \"delete_line\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", item_r8.number);\n  }\n}\nfunction TicketsListComponent_ng_container_1_ul_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\");\n    i0.ɵɵtemplate(1, TicketsListComponent_ng_container_1_ul_6_ng_container_1_Template, 4, 6, \"ng-container\", 5);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.ticket_list);\n  }\n}\nfunction TicketsListComponent_ng_container_1_app_winner_list_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-winner-list\");\n  }\n}\nfunction TicketsListComponent_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 2)(2, \"div\", 3);\n    i0.ɵɵtemplate(3, TicketsListComponent_ng_container_1_h2_3_Template, 2, 1, \"h2\", 1);\n    i0.ɵɵtemplate(4, TicketsListComponent_ng_container_1_h2_4_Template, 4, 0, \"h2\", 1);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 4);\n    i0.ɵɵtemplate(6, TicketsListComponent_ng_container_1_ul_6_Template, 2, 1, \"ul\", 1);\n    i0.ɵɵtemplate(7, TicketsListComponent_ng_container_1_app_winner_list_7_Template, 1, 0, \"app-winner-list\", 1);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.caps.generate_tickets());\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.caps.generate_tickets());\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.caps.generate_tickets());\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.caps.generate_tickets());\n  }\n}\nfunction TicketsListComponent_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 12)(2, \"div\", 13);\n    i0.ɵɵelement(3, \"app-first-letter-bold-text\", 14);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"text\", \"Load ...\");\n  }\n}\nexport let TicketsListComponent = /*#__PURE__*/(() => {\n  var _class;\n  class TicketsListComponent {\n    /**\n     * @description:\n     * @param playroomService\n     */\n    constructor(playroomService) {\n      this.playroomService = playroomService;\n      /**\n       * @description:\n       */\n      this.ticket_list = [];\n      /**\n       * @description:\n       */\n      this.ticket_counter = 0;\n      /**\n       * @description:\n       */\n      this.caps = new CapsuleTime();\n    }\n    /**\n     * @description:\n     */\n    ngOnInit() {\n      this.bindPlayroomStream();\n      this.bindPlayroomWinningTicketPrintRun();\n    }\n    /**\n     * @description:\n     */\n    bindPlayroomStream() {\n      this.playroomService.stream.subscribe(data => {\n        let event_key = 'recept__' + data.event;\n        if (this[event_key] === undefined) {\n          alert(event_key + ' is not defined in ticket-list.component.ts');\n        }\n        this[event_key](data.data);\n      });\n    }\n    /**\n     * @description: Sert de recepteur pour l'evenement de tirage de ticket gagnant\n     */\n    bindPlayroomWinningTicketPrintRun() {\n      this.playroomService.stream_winning_number.subscribe(data => {\n        for (let tiket of this.ticket_list) {\n          let encountred = false;\n          for (let num of tiket.number) {\n            if (num.value === data.number && num.state !== 'gold') {\n              encountred = true;\n              num.state = 'gold';\n              break;\n            }\n          }\n          if (!encountred) {\n            for (let num of tiket.number) {\n              num.state = 'grey';\n            }\n            tiket.state = 'delete_line';\n          }\n        }\n        this.updateTicketCounter();\n      });\n    }\n    /**\n     * @description:\n     */\n    recept__lottery_ticket_values(data) {}\n    /**\n     * @description:\n     */\n    recept__account_balance(data) {}\n    /**\n     * @description:\n     */\n    recept__party_time(data) {\n      this.caps = data.caps;\n    }\n    /**\n     * @description:\n     */\n    recept__ticket_list(data) {\n      // TODO: remove this when is finished.\n      // if (this.ticket_list.length !== 0) { return; }\n      this.ticket_list = [];\n      for (let number of data) {\n        let is_winning_ticket = this.hasWinningTicket(number);\n        number = this.getWinningTicket(is_winning_ticket, number);\n        this.ticket_list.push({\n          number: this.explodeTicket(number),\n          state: 'none'\n        });\n      }\n      this.updateTicketCounter();\n    }\n    /**\n     * @description:\n     */\n    recept__jackpot(data) {}\n    /**\n     * @description: the winning number have >>> before and <<< after\n     */\n    hasWinningTicket(ticket) {\n      return ticket.indexOf('>>>') !== -1;\n    }\n    /**\n     * @description: expurge the winning number\n     */\n    getWinningTicket(is_winning_ticket, ticket) {\n      if (!is_winning_ticket) return ticket;\n      return ticket.replace('>>>', '').replace('<<<', '');\n    }\n    /**\n     * @description: the number has 21132133 format\n     * @return Array<any>\n     */\n    explodeTicket(ticket) {\n      let ticket_list = [];\n      for (let i = 0; i < ticket.length; i++) {\n        ticket_list.push({\n          value: ticket[i],\n          state: 'none'\n        });\n      }\n      return ticket_list;\n    }\n    /**\n     * @description:\n     */\n    updateTicketCounter() {\n      this.ticket_counter = this.ticket_list.length;\n      for (let ticket of this.ticket_list) {\n        if (ticket.state === 'delete_line') {\n          this.ticket_counter--;\n        }\n      }\n      // -> end party\n      if (this.ticket_counter === 0) {\n        this.playroomService.endpartynext('gameover');\n      }\n    }\n    /**\n     * @description:\n     */\n    showTicketPart() {\n      return this.caps.generate_tickets();\n    }\n    /**\n     * @description:\n     */\n    showWinnerListPart() {\n      return !this.showTicketPart();\n    }\n  }\n  _class = TicketsListComponent;\n  _class.ɵfac = function TicketsListComponent_Factory(t) {\n    return new (t || _class)(i0.ɵɵdirectiveInject(i1.PlayroomService));\n  };\n  _class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: _class,\n    selectors: [[\"app-tickets-list\"]],\n    decls: 3,\n    vars: 2,\n    consts: [[1, \"tickets_list_container\"], [4, \"ngIf\"], [1, \"ticket_list_header\"], [1, \"flex-block\"], [1, \"tickets_list\"], [4, \"ngFor\", \"ngForOf\"], [3, \"ngClass\"], [\"class\", \"line\", 4, \"ngIf\"], [\"class\", \"gold_number\", 4, \"ngFor\", \"ngForOf\"], [1, \"line\"], [1, \"gold_number\"], [3, \"number\", \"gold\"], [1, \"flex-to-center\"], [1, \"loader\"], [3, \"text\"]],\n    template: function TicketsListComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, TicketsListComponent_ng_container_1_Template, 8, 4, \"ng-container\", 1);\n        i0.ɵɵtemplate(2, TicketsListComponent_ng_container_2_Template, 4, 1, \"ng-container\", 1);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.caps.timelaps_is_not_empty());\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.caps.timelaps_is_not_empty());\n      }\n    },\n    styles: [\".tickets_list_container[_ngcontent-%COMP%]   .ticket_list_header[_ngcontent-%COMP%]{height:10%;background-color:green}.tickets_list_container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#fff}.tickets_list_container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:1.5em}.tickets_list_container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#fff;display:inline-block;font-size:1.2em}.tickets_list_container[_ngcontent-%COMP%]   .tickets_list[_ngcontent-%COMP%]{border-top:1px solid #544b4b;margin-left:10px;margin-right:10px;color:#fff;position:absolute;height:90%;overflow:auto;width:94%;overflow-x:hidden}.tickets_list_container[_ngcontent-%COMP%]   .tickets_list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0}.tickets_list_container[_ngcontent-%COMP%]   .tickets_list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-top:15px;margin-bottom:15px;height:37px}.tickets_list_container[_ngcontent-%COMP%]   .tickets_list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;width:14.2857142857%;display:inline-block;text-align:center;margin:0;height:36px;vertical-align:top}.tickets_list_container[_ngcontent-%COMP%]   .tickets_list[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{width:98%;height:2px;background:grey;position:absolute;margin-top:13px;animation-name:_ngcontent-%COMP%_TraceLine;animation-duration:1s}@keyframes _ngcontent-%COMP%_TraceLine{0%{width:0%}to{width:98%}}.tickets_list_container[_ngcontent-%COMP%]   .tickets_list[_ngcontent-%COMP%]   .delete_this_line[_ngcontent-%COMP%]{animation-name:_ngcontent-%COMP%_DeleteLine;animation-duration:2s;animation-delay:.5s;animation-name:_ngcontent-%COMP%_ReduceSize;animation-duration:.5s;animation-delay:1s;animation-fill-mode:forwards;animation-iteration-count:1;overflow:hidden}@keyframes _ngcontent-%COMP%_DeleteLine{0%{transform:translate(0);opacity:1;background-color:#ce1515}to{opacity:0;transform:translate(100%);height:37px}}@keyframes _ngcontent-%COMP%_ReduceSize{0%{opacity:1;height:37px}to{opacity:0;height:0px;margin:0}}\"]\n  });\n  return TicketsListComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}