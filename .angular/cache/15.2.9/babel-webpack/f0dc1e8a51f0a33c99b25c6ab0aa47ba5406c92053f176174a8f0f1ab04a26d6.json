{"ast":null,"code":"var _class;\nimport { CapsuleTime } from 'src/app/services/playroom.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/playroom.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../../tools/first-letter-bold-text/first-letter-bold-text.component\";\nimport * as i4 from \"../../tools/gold-number/gold-number.component\";\nimport * as i5 from \"../../nav/winner-list/winner-list.component\";\nfunction TicketsListComponent_ng_container_1_h2_3_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1, \"My \");\n    i0.ɵɵelementStart(2, \"strong\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \" tickets\");\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r6.ticket_counter);\n  }\n}\nfunction TicketsListComponent_ng_container_1_h2_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h2\");\n    i0.ɵɵtemplate(1, TicketsListComponent_ng_container_1_h2_3_ng_container_1_Template, 5, 1, \"ng-container\", 1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.ticket_counter !== 0);\n  }\n}\nfunction TicketsListComponent_ng_container_1_h2_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h2\")(1, \"strong\");\n    i0.ɵɵtext(2, \"100\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3, \" Last winner \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TicketsListComponent_ng_container_1_ul_6_ng_container_1_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 9);\n  }\n}\nfunction TicketsListComponent_ng_container_1_ul_6_ng_container_1_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 10);\n    i0.ɵɵelement(1, \"app-gold-number\", 11);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const number_r12 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"number\", number_r12.value)(\"gold\", number_r12.state);\n  }\n}\nconst _c0 = function (a0, a1) {\n  return {\n    \"delete_this_line\": a0,\n    \"winner\": a1\n  };\n};\nfunction TicketsListComponent_ng_container_1_ul_6_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"li\", 6);\n    i0.ɵɵtemplate(2, TicketsListComponent_ng_container_1_ul_6_ng_container_1_div_2_Template, 1, 0, \"div\", 7);\n    i0.ɵɵtemplate(3, TicketsListComponent_ng_container_1_ul_6_ng_container_1_span_3_Template, 2, 2, \"span\", 8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const item_r8 = ctx.$implicit;\n    const i_r9 = ctx.index;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(3, _c0, item_r8.state === \"delete_line\", i_r9 === 0));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", item_r8.state === \"delete_line\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", item_r8.number);\n  }\n}\nfunction TicketsListComponent_ng_container_1_ul_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\");\n    i0.ɵɵtemplate(1, TicketsListComponent_ng_container_1_ul_6_ng_container_1_Template, 4, 6, \"ng-container\", 5);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.ticket_list);\n  }\n}\nfunction TicketsListComponent_ng_container_1_app_winner_list_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-winner-list\");\n  }\n}\nfunction TicketsListComponent_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 2)(2, \"div\", 3);\n    i0.ɵɵtemplate(3, TicketsListComponent_ng_container_1_h2_3_Template, 2, 1, \"h2\", 1);\n    i0.ɵɵtemplate(4, TicketsListComponent_ng_container_1_h2_4_Template, 4, 0, \"h2\", 1);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 4);\n    i0.ɵɵtemplate(6, TicketsListComponent_ng_container_1_ul_6_Template, 2, 1, \"ul\", 1);\n    i0.ɵɵtemplate(7, TicketsListComponent_ng_container_1_app_winner_list_7_Template, 1, 0, \"app-winner-list\", 1);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.caps.generate_tickets());\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.caps.generate_tickets());\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.caps.generate_tickets());\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.caps.generate_tickets());\n  }\n}\nfunction TicketsListComponent_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 12)(2, \"div\", 13);\n    i0.ɵɵelement(3, \"app-first-letter-bold-text\", 14);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"text\", \"Load ...\");\n  }\n}\nexport class TicketsListComponent {\n  /**\n   * @description:\n   * @param playroomService\n   */\n  constructor(playroomService) {\n    this.playroomService = playroomService;\n    /**\n     * @description:\n     */\n    this.ticket_list = [];\n    /**\n     * @description:\n     */\n    this.ticket_counter = 0;\n    /**\n     * @description:\n     */\n    this.caps = new CapsuleTime();\n  }\n  /**\n   * @description:\n   */\n  ngOnInit() {\n    this.bindPlayroomStream();\n    this.bindPlayroomWinningTicketPrintRun();\n  }\n  /**\n   * @description:\n   */\n  bindPlayroomStream() {\n    this.playroomService.stream.subscribe(data => {\n      let event_key = 'recept__' + data.event;\n      if (this[event_key] === undefined) {\n        alert(event_key + ' is not defined in ticket-list.component.ts');\n      }\n      this[event_key](data.data);\n    });\n  }\n  /**\n   * @description: Sert de recepteur pour l'evenement de tirage de ticket gagnant\n   */\n  bindPlayroomWinningTicketPrintRun() {\n    this.playroomService.stream_winning_number.subscribe(data => {\n      for (let tiket of this.ticket_list) {\n        let encountred = false;\n        for (let num of tiket.number) {\n          if (num.value === data.number && num.state !== 'gold') {\n            encountred = true;\n            num.state = 'gold';\n            break;\n          }\n        }\n        if (!encountred) {\n          for (let num of tiket.number) {\n            num.state = 'grey';\n          }\n          tiket.state = 'delete_line';\n        }\n      }\n      this.updateTicketCounter();\n    });\n  }\n  /**\n   * @description:\n   */\n  recept__lottery_ticket_values(data) {}\n  /**\n   * @description:\n   */\n  recept__account_balance(data) {}\n  /**\n   * @description:\n   */\n  recept__party_time(data) {\n    this.caps = data.caps;\n  }\n  /**\n   * @description:\n   */\n  recept__ticket_list(data) {\n    // TODO: remove this when is finished.\n    // if (this.ticket_list.length !== 0) { return; }\n    this.ticket_list = [];\n    for (let number of data) {\n      let is_winning_ticket = this.hasWinningTicket(number);\n      number = this.getWinningTicket(is_winning_ticket, number);\n      this.ticket_list.push({\n        number: this.explodeTicket(number),\n        state: 'none'\n      });\n    }\n    this.updateTicketCounter();\n  }\n  /**\n   * @description:\n   */\n  recept__jackpot(data) {}\n  /**\n   * @description: the winning number have >>> before and <<< after\n   */\n  hasWinningTicket(ticket) {\n    return ticket.indexOf('>>>') !== -1;\n  }\n  /**\n   * @description: expurge the winning number\n   */\n  getWinningTicket(is_winning_ticket, ticket) {\n    if (!is_winning_ticket) return ticket;\n    return ticket.replace('>>>', '').replace('<<<', '');\n  }\n  /**\n   * @description: the number has 21132133 format\n   * @return Array<any>\n   */\n  explodeTicket(ticket) {\n    let ticket_list = [];\n    for (let i = 0; i < ticket.length; i++) {\n      ticket_list.push({\n        value: ticket[i],\n        state: 'none'\n      });\n    }\n    return ticket_list;\n  }\n  /**\n   * @description:\n   */\n  updateTicketCounter() {\n    this.ticket_counter = this.ticket_list.length;\n    for (let ticket of this.ticket_list) {\n      if (ticket.state === 'delete_line') {\n        this.ticket_counter--;\n      }\n    }\n    // -> end party\n    if (this.ticket_counter === 0) {\n      this.playroomService.endpartynext('gameover');\n    }\n  }\n  /**\n   * @description:\n   */\n  showTicketPart() {\n    return this.caps.generate_tickets();\n  }\n  /**\n   * @description:\n   */\n  showWinnerListPart() {\n    return !this.showTicketPart();\n  }\n}\n_class = TicketsListComponent;\n_class.ɵfac = function TicketsListComponent_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i1.PlayroomService));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"app-tickets-list\"]],\n  decls: 3,\n  vars: 2,\n  consts: [[1, \"tickets_list_container\"], [4, \"ngIf\"], [1, \"ticket_list_header\"], [1, \"flex-block\"], [1, \"tickets_list\"], [4, \"ngFor\", \"ngForOf\"], [3, \"ngClass\"], [\"class\", \"line\", 4, \"ngIf\"], [\"class\", \"gold_number\", 4, \"ngFor\", \"ngForOf\"], [1, \"line\"], [1, \"gold_number\"], [3, \"number\", \"gold\"], [1, \"flex-to-center\"], [1, \"loader\"], [3, \"text\"]],\n  template: function TicketsListComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵtemplate(1, TicketsListComponent_ng_container_1_Template, 8, 4, \"ng-container\", 1);\n      i0.ɵɵtemplate(2, TicketsListComponent_ng_container_2_Template, 4, 1, \"ng-container\", 1);\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.caps.timelaps_is_not_empty());\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.caps.timelaps_is_not_empty());\n    }\n  },\n  dependencies: [i2.NgClass, i2.NgForOf, i2.NgIf, i3.FirstLetterBoldTextComponent, i4.GoldNumberComponent, i5.WinnerListComponent],\n  styles: [\".tickets_list_container[_ngcontent-%COMP%]   .ticket_list_header[_ngcontent-%COMP%] {\\n  height: 10%;\\n  background-color: green;\\n}\\n.tickets_list_container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\\n  color: #fff;\\n}\\n.tickets_list_container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%] {\\n  font-size: 1.5em;\\n}\\n.tickets_list_container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\\n  color: white;\\n  display: inline-block;\\n  font-size: 1.2em;\\n}\\n.tickets_list_container[_ngcontent-%COMP%]   .tickets_list[_ngcontent-%COMP%] {\\n  border-top: 1px solid #544b4b;\\n  margin-left: 10px;\\n  margin-right: 10px;\\n  color: white;\\n  position: absolute;\\n  height: 90%;\\n  overflow: auto;\\n  width: 94%;\\n  overflow-x: hidden;\\n  \\n}\\n.tickets_list_container[_ngcontent-%COMP%]   .tickets_list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] {\\n  list-style: none;\\n  margin: 0;\\n  padding: 0;\\n}\\n.tickets_list_container[_ngcontent-%COMP%]   .tickets_list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%] {\\n  margin-top: 15px;\\n  margin-bottom: 15px;\\n  height: 37px;\\n}\\n.tickets_list_container[_ngcontent-%COMP%]   .tickets_list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\\n  font-size: 20px;\\n  margin-left: 5px;\\n  margin-right: 5px;\\n  width: 14.2857142857%;\\n  display: inline-block;\\n  text-align: center;\\n  margin: 0;\\n  height: 36px;\\n  vertical-align: top;\\n}\\n.tickets_list_container[_ngcontent-%COMP%]   .tickets_list[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%] {\\n  width: 98%;\\n  height: 2px;\\n  background: grey;\\n  position: absolute;\\n  margin-top: 13px;\\n  animation-name: _ngcontent-%COMP%_TraceLine;\\n  animation-duration: 1s;\\n}\\n@keyframes _ngcontent-%COMP%_TraceLine {\\n  from {\\n    width: 0%;\\n  }\\n  to {\\n    width: 98%;\\n  }\\n}\\n.tickets_list_container[_ngcontent-%COMP%]   .tickets_list[_ngcontent-%COMP%]   .delete_this_line[_ngcontent-%COMP%] {\\n  animation-name: _ngcontent-%COMP%_DeleteLine;\\n  animation-duration: 2s;\\n  animation-delay: 0.5s;\\n  animation-fill-mode: forwards;\\n  animation-iteration-count: 1;\\n  animation-name: _ngcontent-%COMP%_ReduceSize;\\n  animation-duration: 0.5s;\\n  animation-delay: 1s;\\n  animation-fill-mode: forwards;\\n  animation-iteration-count: 1;\\n  overflow: hidden;\\n}\\n@keyframes _ngcontent-%COMP%_DeleteLine {\\n  from {\\n    transform: translate(0%, 0px);\\n    opacity: 1;\\n    background-color: rgb(206, 21, 21);\\n  }\\n  to {\\n    opacity: 0;\\n    transform: translate(100%, 0px);\\n    height: 37px;\\n  }\\n}\\n@keyframes _ngcontent-%COMP%_ReduceSize {\\n  from {\\n    opacity: 1;\\n    height: 37px;\\n  }\\n  to {\\n    opacity: 0;\\n    height: 0px;\\n    margin: 0px;\\n  }\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvdGlja2V0cy90aWNrZXRzLWxpc3QvdGlja2V0cy1saXN0LmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNJO0VBQ0ksV0FBQTtFQUNBLHVCQUFBO0FBQVI7QUFHSTtFQUNJLFdBQUE7QUFEUjtBQUVRO0VBQ0ksZ0JBQUE7QUFBWjtBQUlJO0VBQ0ksWUFBQTtFQUNBLHFCQUFBO0VBQ0EsZ0JBQUE7QUFGUjtBQUtJO0VBQ0ksNkJBQUE7RUFDQSxpQkFBQTtFQUNBLGtCQUFBO0VBQ0EsWUFBQTtFQUNBLGtCQUFBO0VBQ0EsV0FBQTtFQUNBLGNBQUE7RUFDQSxVQUFBO0VBQ0Esa0JBQUE7RUFvQ0EsdUJBQUE7QUF0Q1I7QUFLUTtFQUNJLGdCQUFBO0VBQ0EsU0FBQTtFQUNBLFVBQUE7QUFIWjtBQUlZO0VBQ0ksZ0JBQUE7RUFDQSxtQkFBQTtFQUNBLFlBQUE7QUFGaEI7QUFJZ0I7RUFDSSxlQUFBO0VBQ0EsZ0JBQUE7RUFDQSxpQkFBQTtFQUNBLHFCQUFBO0VBQ0EscUJBQUE7RUFDQSxrQkFBQTtFQUNBLFNBQUE7RUFDQSxZQUFBO0VBQ0EsbUJBQUE7QUFGcEI7QUFPUTtFQUNJLFVBQUE7RUFDQSxXQUFBO0VBQ0EsZ0JBQUE7RUFDQSxrQkFBQTtFQUNBLGdCQUFBO0VBQ0EseUJBQUE7RUFDQSxzQkFBQTtBQUxaO0FBU1E7RUFDSTtJQUNJLFNBQUE7RUFQZDtFQVNVO0lBQ0ksVUFBQTtFQVBkO0FBQ0Y7QUFXUTtFQUNJLDBCQUFBO0VBQ0Esc0JBQUE7RUFDQSxxQkFBQTtFQUNBLDZCQUFBO0VBQ0EsNEJBQUE7RUFFQSwwQkFBQTtFQUNBLHdCQUFBO0VBQ0EsbUJBQUE7RUFDQSw2QkFBQTtFQUNBLDRCQUFBO0VBQ0EsZ0JBQUE7QUFWWjtBQWFRO0VBQ0k7SUFDSSw2QkFBQTtJQUNBLFVBQUE7SUFDQSxrQ0FBQTtFQVhkO0VBYVU7SUFDSSxVQUFBO0lBQ0EsK0JBQUE7SUFDQSxZQUFBO0VBWGQ7QUFDRjtBQWNRO0VBQ0k7SUFDSSxVQUFBO0lBQ0EsWUFBQTtFQVpkO0VBY1U7SUFDSSxVQUFBO0lBQ0EsV0FBQTtJQUNBLFdBQUE7RUFaZDtBQUNGIiwic291cmNlc0NvbnRlbnQiOlsiLnRpY2tldHNfbGlzdF9jb250YWluZXIge1xuICAgIC50aWNrZXRfbGlzdF9oZWFkZXIge1xuICAgICAgICBoZWlnaHQ6IDEwJTtcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogZ3JlZW47XG4gICAgfVxuICAgIFxuICAgIGgyIHtcbiAgICAgICAgY29sb3I6ICNmZmY7XG4gICAgICAgIHN0cm9uZyB7XG4gICAgICAgICAgICBmb250LXNpemU6IDEuNWVtO1xuICAgICAgICB9ICAgICAgICBcbiAgICB9XG5cbiAgICBoMiB7XG4gICAgICAgIGNvbG9yOiB3aGl0ZTtcbiAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgICAgICBmb250LXNpemU6IDEuMmVtO1xuICAgIH1cblxuICAgIC50aWNrZXRzX2xpc3Qge1xuICAgICAgICBib3JkZXItdG9wOiAxcHggc29saWQgIzU0NGI0YjtcbiAgICAgICAgbWFyZ2luLWxlZnQ6IDEwcHg7XG4gICAgICAgIG1hcmdpbi1yaWdodDogMTBweDtcbiAgICAgICAgY29sb3I6IHdoaXRlO1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgIGhlaWdodDogOTAlO1xuICAgICAgICBvdmVyZmxvdzogYXV0bztcbiAgICAgICAgd2lkdGg6IDk0JTtcbiAgICAgICAgb3ZlcmZsb3cteDogaGlkZGVuO1xuXG5cbiAgICAgICAgdWwge1xuICAgICAgICAgICAgbGlzdC1zdHlsZTogbm9uZTtcbiAgICAgICAgICAgIG1hcmdpbjogMDtcbiAgICAgICAgICAgIHBhZGRpbmc6IDA7XG4gICAgICAgICAgICBsaSB7XG4gICAgICAgICAgICAgICAgbWFyZ2luLXRvcDogMTVweDtcbiAgICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxNXB4O1xuICAgICAgICAgICAgICAgIGhlaWdodDogMzdweDtcblxuICAgICAgICAgICAgICAgIHNwYW4geyBcbiAgICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiAyMHB4O1xuICAgICAgICAgICAgICAgICAgICBtYXJnaW4tbGVmdDogNXB4O1xuICAgICAgICAgICAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDVweDtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDE0LjI4NTcxNDI4NTclO1xuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gICAgICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgICAgICAgICAgICAgICAgbWFyZ2luOiAwO1xuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDM2cHg7XG4gICAgICAgICAgICAgICAgICAgIHZlcnRpY2FsLWFsaWduOiB0b3A7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLmxpbmUge1xuICAgICAgICAgICAgd2lkdGg6IDk4JTtcbiAgICAgICAgICAgIGhlaWdodDogMnB4O1xuICAgICAgICAgICAgYmFja2dyb3VuZDogZ3JleTtcbiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgICAgIG1hcmdpbi10b3A6IDEzcHg7XG4gICAgICAgICAgICBhbmltYXRpb24tbmFtZTogVHJhY2VMaW5lO1xuICAgICAgICAgICAgYW5pbWF0aW9uLWR1cmF0aW9uOiAxcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIFRoZSBhbmltYXRpb24gY29kZSAqL1xuICAgICAgICBAa2V5ZnJhbWVzIFRyYWNlTGluZSB7XG4gICAgICAgICAgICBmcm9tIHtcbiAgICAgICAgICAgICAgICB3aWR0aDogMCU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0byB7XG4gICAgICAgICAgICAgICAgd2lkdGg6IDk4JTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG5cbiAgICAgICAgLmRlbGV0ZV90aGlzX2xpbmUge1xuICAgICAgICAgICAgYW5pbWF0aW9uLW5hbWU6IERlbGV0ZUxpbmU7XG4gICAgICAgICAgICBhbmltYXRpb24tZHVyYXRpb246IDJzO1xuICAgICAgICAgICAgYW5pbWF0aW9uLWRlbGF5OiAwLjVzO1xuICAgICAgICAgICAgYW5pbWF0aW9uLWZpbGwtbW9kZTogZm9yd2FyZHM7XG4gICAgICAgICAgICBhbmltYXRpb24taXRlcmF0aW9uLWNvdW50OiAxO1xuXG4gICAgICAgICAgICBhbmltYXRpb24tbmFtZTogUmVkdWNlU2l6ZTtcbiAgICAgICAgICAgIGFuaW1hdGlvbi1kdXJhdGlvbjogMC41cztcbiAgICAgICAgICAgIGFuaW1hdGlvbi1kZWxheTogMXM7XG4gICAgICAgICAgICBhbmltYXRpb24tZmlsbC1tb2RlOiBmb3J3YXJkcztcbiAgICAgICAgICAgIGFuaW1hdGlvbi1pdGVyYXRpb24tY291bnQ6IDE7XG4gICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgICAgICB9XG5cbiAgICAgICAgQGtleWZyYW1lcyBEZWxldGVMaW5lIHtcbiAgICAgICAgICAgIGZyb20ge1xuICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKDAlLCAwcHgpO1xuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDIwNiwgMjEsIDIxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRvIHtcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAwO1xuICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKDEwMCUsIDBweCk7XG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAzN3B4O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgQGtleWZyYW1lcyBSZWR1Y2VTaXplIHtcbiAgICAgICAgICAgIGZyb20ge1xuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7XG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAzN3B4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdG8ge1xuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDA7XG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAwcHg7XG4gICAgICAgICAgICAgICAgbWFyZ2luOiAwcHg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBcbiAgICAgICAgbGkuZGVsZXRlX3RoaXNfbGluZSBzcGFuIHtcbiAgICAgICAgICAgIC8vIGFuaW1hdGlvbi1uYW1lOiBEZWxldGVMaW5lO1xuICAgICAgICAgICAgLy8gYW5pbWF0aW9uLWR1cmF0aW9uOiAzcztcbiAgICAgICAgICAgIC8vIGFuaW1hdGlvbi1kZWxheTogMC41cztcbiAgICAgICAgICAgIC8vIGFuaW1hdGlvbi1pdGVyYXRpb24tY291bnQ6IDE7XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIFxufSJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["CapsuleTime","i0","TicketsListComponent","constructor","playroomService","ngOnInit","bindPlayroomStream","bindPlayroomWinningTicketPrintRun","stream","subscribe","data","event_key","event","undefined","alert","stream_winning_number","tiket","ticket_list","encountred","num","number","value","state","updateTicketCounter","recept__lottery_ticket_values","recept__account_balance","recept__party_time","caps","recept__ticket_list","is_winning_ticket","hasWinningTicket","getWinningTicket","push","explodeTicket","recept__jackpot","ticket","indexOf","replace","i","length","ticket_counter","endpartynext","showTicketPart","generate_tickets","showWinnerListPart","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["/var/projects/gtender/client2/src/app/tickets/tickets-list/tickets-list.component.ts","/var/projects/gtender/client2/src/app/tickets/tickets-list/tickets-list.component.html"],"sourcesContent":["import { Component } from '@angular/core';\nimport { tick } from '@angular/core/testing';\nimport { PlayroomService } from 'src/app/services/playroom.service'; \nimport { CapsuleTime } from 'src/app/services/playroom.service';\n\n@Component({\n  selector: 'app-tickets-list',\n  templateUrl: './tickets-list.component.html',\n  styleUrls: ['./tickets-list.component.scss']\n})\nexport class TicketsListComponent {\n  /**\n   * @description:\n   */\n  public ticket_list: any = [ ];\n\n  /**\n   * @description:\n   */\n  public ticket_counter: number = 0;\n\n  /**\n   * @description: \n   */\n  public caps: CapsuleTime = new CapsuleTime();\n\n  /**\n   * @description: \n   * @param playroomService \n   */\n  constructor(public playroomService: PlayroomService) { }\n\n  /**\n   * @description:\n   */\n  public ngOnInit(): void {\n    this.bindPlayroomStream();\n    this.bindPlayroomWinningTicketPrintRun();\n  }\n\n  /**\n   * @description:\n   */\n  private bindPlayroomStream(): void {\n    this.playroomService.stream.subscribe((data: any) => {\n      let event_key = 'recept__' + data.event;\n      if ((this as any)[event_key] === undefined) {\n        alert(event_key + ' is not defined in ticket-list.component.ts');\n      }\n      (this as any)[event_key](data.data);\n    });\n  }\n\n\n  /**\n   * @description: Sert de recepteur pour l'evenement de tirage de ticket gagnant\n   */\n  private bindPlayroomWinningTicketPrintRun(): void {\n    this.playroomService.stream_winning_number.subscribe((data: any) => {\n      for (let tiket of this.ticket_list) {\n        let encountred = false;\n        for (let num of tiket.number) {\n          if (num.value === data.number && num.state !== 'gold') {\n            encountred = true;\n            num.state = 'gold';\n            break;\n          }\n        }\n\n        if (!encountred) {\n          for (let num of tiket.number) {\n            num.state = 'grey';\n          }\n          tiket.state = 'delete_line';\n        }\n      }\n      this.updateTicketCounter();\n    });\n  }\n\n  /**\n   * @description: \n   */\n  public recept__lottery_ticket_values(data: any): void { }\n\n  /**\n   * @description: \n   */\n  public recept__account_balance(data: any): void { }\n\n  /**\n   * @description: \n   */\n  public recept__party_time(data: any): void {\n    this.caps = data.caps;\n  }\n\n  /**\n   * @description:\n   */\n  public recept__ticket_list(data: any): void {\n    // TODO: remove this when is finished.\n\n    // if (this.ticket_list.length !== 0) { return; }\n\n    this.ticket_list = [];\n    for (let number of data) {\n      let is_winning_ticket = this.hasWinningTicket(number);\n      number = this.getWinningTicket(is_winning_ticket, number);\n\n      this.ticket_list.push({\n        number: this.explodeTicket(number),\n        state: 'none',\n      });\n    }\n    this.updateTicketCounter();\n  }\n\n  /**\n   * @description: \n   */\n  public recept__jackpot(data: any) { }\n\n  /**\n   * @description: the winning number have >>> before and <<< after\n   */\n  public hasWinningTicket(ticket: string): boolean {\n    return ticket.indexOf('>>>') !== -1;\n  }\n\n  /**\n   * @description: expurge the winning number\n   */\n  public getWinningTicket(\n    is_winning_ticket: boolean, \n    ticket: string\n    ): string {\n    if (!is_winning_ticket) return ticket;\n    return ticket.replace('>>>', '').replace('<<<', '');\n  }\n\n  /**\n   * @description: the number has 21132133 format\n   * @return Array<any>\n   */\n  public explodeTicket(ticket: string): Array<any> {\n    let ticket_list: Array<any> = [];\n    for (let i = 0; i < ticket.length; i++) {\n      ticket_list.push({\n        value: ticket[i],\n        state: 'none',\n      });\n    }\n    return ticket_list;\n  }\n\n  /**\n   * @description:\n   */\n  public updateTicketCounter(): void {\n    this.ticket_counter = this.ticket_list.length;\n    for (let ticket of this.ticket_list) {\n      if (ticket.state === 'delete_line') {\n        this.ticket_counter--;\n      }\n    }\n\n    // -> end party\n    if (this.ticket_counter === 0) {\n      this.playroomService.endpartynext('gameover');\n    }\n  }\n\n  /**\n   * @description: \n   */\n  public showTicketPart(): boolean {\n    return this.caps.generate_tickets();\n  }\n\n  /**\n   * @description:\n   */\n  public showWinnerListPart(): boolean {\n    return !this.showTicketPart();\n  }\n\n}\n","<div class=\"tickets_list_container\">\n    <ng-container *ngIf=\"caps.timelaps_is_not_empty()\">\n        <div class=\"ticket_list_header\">\n            <div \n                class=\"flex-block\">\n                <h2 *ngIf=\"caps.generate_tickets()\">\n                    <ng-container *ngIf=\"ticket_counter !== 0\">My <strong>{{ticket_counter}}</strong> tickets</ng-container> \n                </h2>\n    \n                <h2 *ngIf=\"!caps.generate_tickets()\">\n                    <strong>100</strong> Last winner\n                </h2>\n            </div>\n        </div>\n        <div class=\"tickets_list\">\n            <ul *ngIf=\"caps.generate_tickets()\">\n                <ng-container\n                    *ngFor=\"let item of ticket_list; let i = index\">\n                    <li \n                        [ngClass]=\"{\n                            'delete_this_line': item.state === 'delete_line',\n                            'winner': i === 0\n                        }\">\n                        <div\n                            *ngIf=\"item.state === 'delete_line'\" \n                            class=\"line\"></div>\n\n                        <span \n                            *ngFor=\"let number of item.number\"\n                            class=\"gold_number\">\n                            <app-gold-number \n                                [number]=\"number.value\" \n                                [gold]=\"number.state\"></app-gold-number>\n                        </span>\n                    </li>\n                </ng-container>\n            </ul>\n\n            <app-winner-list *ngIf=\"!caps.generate_tickets()\"></app-winner-list>\n        </div>\n    </ng-container>\n    <ng-container *ngIf=\"!caps.timelaps_is_not_empty()\">\n        <div class=\"flex-to-center\">\n            <div class=\"loader\">\n                <app-first-letter-bold-text [text]=\"'Load ...'\"></app-first-letter-bold-text>\n            </div>\n        </div>\n    </ng-container>\n</div>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}